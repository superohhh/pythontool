#! /usr/bin/env python
# -*- coding: utf-8 -*-
import json
import os
import shutil
import subprocess
import sys

from PySide6.QtCore import Qt, QByteArray
from PySide6.QtGui import QIcon, QPixmap, QStandardItemModel, QStandardItem, QColor
from PySide6.QtWidgets import QWidget, QLabel, QPushButton, QLineEdit, QFileDialog, \
    QVBoxLayout, QTableView, QMessageBox, QDialog, \
    QCheckBox, QHBoxLayout, QCompleter, QDialogButtonBox, QTableWidget, QTableWidgetItem, \
    QHeaderView, QInputDialog, QAbstractItemView

TUBIAO_windows = "0000010001002020000001002000a810000016000000280000002000000040000000010020000000000000100000130b0000130b0000000000000000000084848400848484008484840084848400848484007d7d7d007a7a7a007b7b7b006a6a6a0070707000797979007f7f7f00838383013636369c030303e90e0e0ed50a0a0ad80a0a0ae25d5d5d33717171006f6f6f0079797900767676007c7c7c006e6e6e00686868006c6c6c006e6e6e006e6e6e006e6e6e006e6e6e00ffffff0084848400848484008484840084848400848484007d7d7d00808080007878780c62626217757575007c7c7c007c7c7c0068686828040404ff585858566363631377777718252525cf292929a76d6d6d006f6f6f007e7e7e007474740472727217727272006a6a6a006c6c6c006e6e6e006e6e6e006e6e6e006e6e6e00ffffff0084848400848484008484840084848400858585008585850050505065111111e5080808f43737378d87878700919191004a4a4a650f0f0fef888888047e7e7e00969696004e4e4e81121212e0797979007a7a7a0068686836161616d7090909f42a2a2ab16363631c707070006e6e6e006e6e6e006e6e6e006e6e6e00ffffff007d7d7d007d7d7d007d7d7d007d7d7d00808080033a3a3a97080808fc4c4c4c744e4e4e520a0a0af4313131b16060605f0a0a0aea3c3c3ca1a1a1a100969696008b8b8b0071717132040404ff4343438946464673060606f9333333a1555555461a1a1ad00e0e0ee75e5e5e34707070006c6c6c006c6c6c006c6c6c00ffffff008c8c8c008c8c8c008a8a8a008d8d8d007373732f000000ff6262624d929292007b7b7b006c6c6c2f1d1d1dc9090909f02f2f2fa96b6b6b1771717100767676008a8a8a008f8f8f004f4f4f650f0f0fe2111111e84d4d4d7f8e8e8e00717171008484840c1f1f1fcb272727b67d7d7d00777777007878780078787800ffffff007474740077777700858585008e8e8e007a7a7a2b111111fb60606030777777007979790082828200757575005c5c5c0e7d7d7d00727272006d6d6d00767676008c8c8c008d8d8d00757575006464640678787808949494008c8c8c00707070007a7a7a00222222c0313131ab8f8f8f0088888800818181007b7b7b00ffffff0063636300626262006f6f6f008888880089898901303030cb353535a4727272007171710077777700747474005f5f5f0078787800707070006e6e6e00767676008c8c8c008d8d8d0070707000656565007a7a7a008c8c8c007a7a7a007777770061616134040404fe6b6b6b408e8e8e007d7d7d00737373006f6f6f00ffffff006464640065656500656565006a6a6a006767670044444478323232d67a7a7a007d7d7d007e7e7e0081818100797979104c4c4c63343434a71a1a1add070707f61a1a1ada2b2b2bae585858637272721579797900686868006a6a6a006b6b6b004d4d4d640e0e0eed8181810083838300737373007676760071717100ffffff0066666600616161164d4d4d515656564357575741292929db3d3d3da47a7a7a007f7f7f00818181004e4e4e6e121212e5181818dc2f2f2f962f2f2f5e494949484545455d2525258e141414d4121212e54141417b6b6b6b046c6c6c006a6a6a007a7a7a32010101ff45454578656565394f4f4f565f5f5f3874747400ffffff005d5d5d1c282828dd202020ee212121ec1d1d1df0373737bc727272197c7c7c007e7e7e07292929b6171717e05454545b83838307747474004d4d4d00666666006c6c6c00555555006666660144444449151515d81c1c1cc66a6a6a1073737300707070005757576b101010e90a0a0af00b0b0bea070707f949494974ffffff0046464683292929e6737373115d5d5d1067676715818181007c7c7c007f7f7f00393939b0242424d48e8e8e1681818100838383006d6d6d004949490062626200676767005050500065656500616161007373730c272727bf202020c67777770674747400949494008282820d595959176161610b5353537a070707f0ffffff002d2d2dd54343438d75757500676767006e6e6e007f7f7f007c7c7c0052525271232323f08080801a81818100828282111f1f1fa44c4c4c596d6d6d006969690069696900696969006969690069696900676767009c9c9c0c161616e736363688737373008f8f8f0089898900666666006c6c6c007777771b090909e0ffffff00212121f0525252727f7f7f0077777700717171007e7e7e00707070131f1f1ff169696955969696006a6a6a17888888004c4c4c68000000ff5c5c5c286c6c6c006a6a6a006a6a6a006a6a6a006b6b6b0065656500a3a3a30072727247090909f86767671f8b8b8b00808080006c6c6c0070707000696969170a0a0ad9ffffff0059595975161616f9444444927878780d777777007676760046464670333333d99c9c9c0199999900343434ab4343436a36363686000000ff4b4b4b466767670061616100626262005c5c5c0062626200666666008c8c8c00929292001e1e1ed34444447d707070006e6e6e00717171004f4f4f51141414e21a1a1ad2ffffff00868686006666664e232323e8393939b57b7b7b0279797900353535b94747478e838383007c7c7c0073737349191919fa141414ff050505ff1c1c1cc86e6e6e177676760074747400646464005f5f5f0066666600969696009f9f9f005454547b1b1b1bcb6a6a6a006f6f6f0051515153060606fe373737957d7d7d11ffffff007c7c7c00808080005b5b5b351d1d1dfc7e7e7e208d8d8d00252525e1575757567474740070707000969696005151511f4545453d3b3b3bbb000000ff1c1c1ccb6d6d6d1778787800646464005f5f5f00666666007070700074747400545454480d0d0de57979790080808000292929b2242424bb808080007f7f7f00ffffff00686868007a7a7a0052525261212121f58181811689898900212121ed5252524265656500626262009393930055555500555555009797970d363636be000000ff1b1b1bcc70707016686868005f5f5f00666666005555550058585800474747380b0b0be9858585008d8d8d003a3a3a95121212db6f6f6f0c7a7a7a00ffffff00636363163e3e3e9f161616fd5c5c5c73a0a0a0009c9c9c00282828df49494953606060005d5d5d009393930054545400505050009f9f9f009292920d383838bd000000ff1d1d1dcc5c5c5c1e63636301696969006b6b6b006f6f6f00535353440e0e0ee58f8f8f00919191007f7f7f1f161616d6121212de5a5a5a52ffffff00343434b6232323e5686868448d8d8d009b9b9b0090909000373737bf46464681747474006e6e6e0093939300545454004f4f4f009c9c9c009b9b9b009494940e3c3c3cbd040404ff070707ee0f0f0fde47474761666666006c6c6c003a3a3a77232323cb858585008f8f8f009b9b9b006767670f3a3a3a9d070707f1ffffff00202020f04e4e4e657c7c7c007777770068686800747474005f5f5f73282828d46c6c6c006868680093939300535353004f4f4f008484840080808000858585007a7a7a11222222eb101010f12f2f2fa8161616e07d7d7d0084848400222222c44545458b646464006b6b6b0077777700717171007e7e7e00141414cbffffff00363636c03e3e3ea787878700737373005c5c5c00787878007f7f7f1c212121f75d5d5d457575750091919100696969007b7b7b00808080007f7f7f0080808000838383002a2a2adc333333b2848484006868683e7f7f7f0062626238060606fc80808026686868006d6d6d006c6c6c007878780059595935020202efffffff005c5c5c561b1b1bfb5c5c5c5457575755424242636e6e6e21898989004b4b4b8b232323e37474740a9292920091919100979797009595950095959500959595009b9b9b006a6a6a50262626df5b5b5b477979790075757508181818d84040409a97979700686868054d4d4d4f444444635959594f282828b41c1c1cd4ffffff009a9a9a04464646951d1d1dec222222e4262626e2212121f06969693e919191063b3b3bc2363636be7b7b7b09737373006f6f6f007a7a7a00696969006f6f6f00787878006f6f6f00797979008181810074747407292929b4212121cda6a6a60868686809262626b5090909fa0f0f0fe0090909ec131313d579797934ffffff00acacac007b7b7b006565650d6363630879797907343434b3353535bf9e9e9e009090900e333333c8282828d26161613a747474007f7f7f006c6c6c00717171007b7b7b00747474007f7f7f006e6e6e322e2e2ecb282828cf92929212adadad005454544e040404fe6a6a6a355d5d5d045353530d6666660390909000ffffff00a9a9a900777777006969690069696900808080004c4c4c7f313131d19a9a9a00949494008b8b8b084a4a4a931e1e1ef1323232bc595959655b5b5b386565652a68686835515151663a3a3ab21e1e1ef24141419b7070700b9d9d9d00a8a8a8005f5f5f57080808f267676708636363005b5b5b00676767008c8c8c00ffffff00a9a9a9007a7a7a006f6f6f00747474007373730b242424e6535353809a9a9a00919191008d8d8d008d8d8d005f5f5f303f3f3f91282828d2222222df212121e2242424e02b2b2bd23838389c5f5f5f357f7f7f007474740099999900a8a8a8007777771a101010f549494968767676006e6e6e00656565008c8c8c00ffffff007f7f7f0079797900787878007b7b7b00656565371d1d1dfb6565651a6c6c6c00666666006767670064646421686868395c5c5c1380808000848484007c7c7c0068686800696969006e6e6e006a6a6a2d5f5f5f3973737303838383007878780076767600373737a92b2b2bc17a7a7a0076767600767676007a7a7a00ffffff00919191009292920092929200959595008888881c212121f44242428c7b7b7b006d6d6d004646467b1c1c1cf71c1c1cf4202020e86b6b6b377f7f7f00787878006f6f6f006f6f6f043b3b3ba21b1b1bf81a1a1af72d2d2dca7c7c7c1b82828200606060371e1e1eed515151868c8c8c00868686008686860085858500ffffff009d9d9d009d9d9d009d9d9d009d9d9d00a0a0a0006969694a1e1e1eed2f2f2fc5363636b01b1b1bf85353535e7373731d414141b22a2a2ace65656500696969007c7c7c005f5f5f4c1b1b1bff5e5e5e4364646423383838c3272727e24343439e1d1d1df93636369b9292920aa1a1a1009e9e9e009e9e9e009e9e9e00ffffff009b9b9b009b9b9b009b9b9b009b9b9b009a9a9a008a8a8a007272721d3939399f222222b26161613a76767600828282006868684a1d1d1df97373730b5e5e5e005f5f5f003737379b383838c68b8b8b008484840089898906484848872e2e2eb9525252586f6f6f008f8f8f009c9c9c009a9a9a009a9a9a009a9a9a00ffffff009b9b9b009b9b9b009b9b9b009b9b9b009a9a9a0084848400808080006969690041414100757575007f7f7f009a9a9a008f8f8f15232323f54343438c47474746434343521e1e1ef15a5a5a79969696009191910089898900808080007b7b7b006a6a6a006c6c6c008e8e8e009c9c9c009a9a9a009a9a9a009a9a9a00ffffff009b9b9b009b9b9b009b9b9b009b9b9b009a9a9a00848484007e7e7e00656565003f3f3f007171710088888800a6a6a600a9a9a9006e6e6e56212121da1e1e1ee8161616e6383838a28282820a8686860089898900888888007b7b7b0076767600676767006c6c6c008e8e8e009c9c9c009a9a9a009a9a9a009a9a9a00ffffff00fff01ffffe701cfffc31983ff003801ff183c31ff1efe79ff1ffff1ff9e00f3f81c003030107c181071ff0c13e23f8f93c51fc790c41fe7184c0fe61c4e07e67c4f83e630cfc0e611cfe06713cff067d3c7f9479023f8881001ff001c10fe103f980031ff1e00f1ff1c7e39ff183811ff803801ffc31987ffff01ffffff81fff"
TUBIAO_refresh_button = b'00000100040010100000000020004b02000046000000181800000000200096030000910200002020000000002000330500002706000030300000000020001b0500005a0b000089504e470d0a1a0a0000000d49484452000000100000001008060000001ff3ff610000021249444154789c9d93b16b144114c67f3bb31beeb2b77373bbb7296e590857eba59518ac630a4b8b10088869d28bf636292c847449e0621796fc0b46b41259d4c2ff2077a688e12262e0c8dd8cc5ed428c9e043f98e1c1f07def7defcd83091c002104699a2e29a5f65bad56dff3bc9e94f2b8dd6e5f84617890a6e99210a2a020cacb016c966555a5d4ee603078e179de17dff7572e2f2f6f8dc7e3dbc3e1f08eb5f6d3f9f9f94ba5d45e966555c0000180d8dcdcac8561f82e8aa2ed3ccf3da6a0dbed56b4d63b8d46e3edf2f2720c7c404a49bd5e3f989b9bdb92529676dc2bd53945ec02482989e3f8b952ea8d10a2471cc7eb41101c15dedcb21f53208166a7d3f167676773c0d26c360f9324592988720ab114f581d7c047c7713e037dd6d6d67c6bedbfb25e17d24008d401dfb9f250c2de50ec0fe2ff70acc3c497cbc4bf01bedfa40a2104abababbe03f41dc739b5d61a60003c007e1699fe2624019324c9fde170f808c0562a95bcd3e9f84093e99328cb77851004417014c7f1ba1042f46766667e9c9c9c3c93527e03c64cff48564a390ac3704b4a797a7676f64a1863be2e2e2e3e1c8d46f78220d8e976bb156054f4c316c700a33ccf3dadf5b631e6eec6c6c663638c806221b22cab6aadf78220c81b8dc6d324491698cc5ccfcfcf2f4451f4a456abbdd75aef16cbf4db4444d9d9344d97a2283a68b7db17aeeb1e7b9ed76bb55a7da5d4feb57576007e013451941c5f64b7730000000049454e44ae42608289504e470d0a1a0a0000000d4948445200000018000000180806000000e0773df80000035d49444154789cb556416b1b47187d333b33bbe3dd9588461112962c31b67a580b9d54b63af99a3fe0084473d161138a4bab1e4a54437c4820979c12f035f86a72f2a9580727e0f607f412720a31e4923a8138095511d6f4a0dd5a91dcd4769b07df65f79bf7bd79337cdf00b3b000c0b22c743a9d722693e96aad9fe6f379430831945293cbe54c1886a6542aad4751b4c018fb68ed04c80c392104ed76bbac947a28a57ceb38ceefd96c76574a791b401740d775dd3bbeefef0a21de388ef34e29b5d56ab52a841000a0a788060050c618eaf5fa3529e5a1e779cfb5d6373637372fd9b68d0995608cc1711cf47abdcb954ae53bcff35e4a295fd7ebf56b711e05600370936d588c3154abd575218429140af78c31325694e4b0a92000400841bfdf4f2ba51e08218cd6fa565c640dc0abd86e0bcbcbcbdf70ce4dad56bbce39ff5bec693e4e79cc0080738e20087ee09c9b46a3d1b26dbb03c000009acde6978cb1d1d2d2d2cdb8baf52fc433f602b0196328168b7739e7efd3e9f46300c7104220954afde2fbfe9358f979c93f02630c4aa94794520360c84aa5d2d5838383661886cdfdfdfd24cf9c918fc4b902c07500de68343a1e0c061f8c3100c0c8fcfcfcfdc160f0c5d1d1d195e170982c382b927c17c06f0072004600fe04f00700a0dbedcaeded6d89ff604bbc56c4c131bea2328ecf0b8213e5e7b1e69fb83e59601a9fa5e0ff0e82938318c591541ee2e2bb207b7b7bf6cece0e21005ec41f25c6a74f31ee2175001f707215cf4cce3937a954eae7b9b9b96700600821c675dd2d4ae98f007a00bec5f8ca01e7f0727575d50280959595af38e7a3c5c5c5ab0030a4941aa5d4a3c9967c01100016e71cbeef3ff13cef5721c61a8fd3e9f463cef9fb62b178372e9258752e72c618b4d63739e7260cc330f9696cdbee341a8d16e7dc0441d0bd68bb8e5bbd098260cdb22c24225f01588babdf1242986c36fba0dfefa7cf3a708c31b25028dc1342986ab5fad374cb77134b2646e66bcff35e6aadbfeff57a971dc7991999b66d63636323a3b5bee179de7329e561ad56fb7a62649e0a4a0841abd5aa28a5b61cc779278478e3fbfeaeebba77100f7d29e56da5d4aee3388752cab74aa987ed76bb1cef78fa6531e3b195a88ca268a15c2eaf87616872b99ca1941a4288c9e7f3466bfd3493c974a3285a88fd3e95fc2febe0c59b1a8d07720000000049454e44ae42608289504e470d0a1a0a0000000d4948445200000020000000200806000000737a7af4000004fa49444154789ced57dd4b54691c7e7eefc78ce53973ce998671d649ca68607094520966176468984011bcb09d1084baa9c1d8bdd060d7c19b09a6602e0aa3a52ec41084bd5817f6d6d02bff804583ae8accd584a08ba8a5d4cdfaedc59cb33b9992d5b474b10f9c9bf3befcbe3f9e17d819e47e00809999997acbb28ea752a95bededed1c080498885808c1b66df3d1a347b9bfbf7f2d168b754f4d4d457792b32b140a050100524a140a8583d168b468dbf6bc528a898801fc05e0218045f77be8fe6321045b96b51089442ee7f3f9c3524a4facd8ad7e0100b3b3b3567373735e6bfd8c88d834cd07a6695eefe9e9395d2a9512a954aa06800f802f9bcdeeb976ed5a735757d7d9dadada9ba6692e0360adf5f344223132313161efca886c362b01607878f888e33873aee2fbf1783c373636b65f29f55eebb5d6c8e7f387e2f1f8a061184b00d8719cb90b172eb456e820003500fcef78ded7d797761c675129c58d8d8dd7272727c315615415022af34acc4cee9904cae91b1d1d3d188944c6a5946cdbf683dedede8c7b7f2f80df012c0128e79c8830303090340c634508b196c964067c3e9fa7407a75b11bb877250030332593c91f85101b8661ac0c0c0c24890844b40a80bdcb343e3e5e1f0c061794522fbbbbbbcf68adbda87c5805bf6b0869ad914ea7bfd75a6f0483c18562b1d840447789e80d00089fcf877038fc0b006e6b6b1b713d97ccfcd1cab718a198593435355d02c09148645e4af9140003003a3a3a4e4a295f8542a1dbaed24f56bc1da4940885423344e4b533e3c99327a66559d35aebf553a74e2589e89f6ea80208e54ad7006a72b99c4ea7d327fc7eff0b00af01bc46737373b7949243a1d0cfaef7a21aa1775103e00e8055002b001e01f8838836510e3f8bbababa034aa947c78e1dfb8d88389bcd921b9ecf0146b9b656509e9e0fa950282800818b172f3efd0c8a09e569c9f00aeedfff5f16be3c8bfec77f802f23ed5e9b78d8da2a0497e9545329338b52a964adafafff09bc4dab1ea13cb156509e5e77509e66558137e23b3b3bbff5fbfdcb994ce6bc02d0080044f49a995751dee3559f84cc4c44c4cc4ca150a8777373b3e1f1e3c7cb80bb14fc7eff8b743a7d2297cb6994bdd6282f926a158b7417ddd75aeb0dcbb26edfbb772f0000ecadc75028345341bfaa0d6266dab76fdf6d21c4ab8e8e8e93de014b299fd6d5d5cd03e0a6a6a64bcc2c00a80fa1613bc1ddacd2e7f3a1adad6d040087c3e15f5dd22340446f88e8ee952b571a82c1e082d67a239d4e7fe75232fac4d54c0084d61a9d9d9d6794522f83c1e09db1b1b1fd00c873908968750b295d4f26933fb846009f404a7d3e1f3299cc7921c49a6118cbe7ce9dfb868850296f09658abc17007a7b7b33b66d2f4a293912898c8f8e8e1eac780fc86c362bb7a16d04e01d5a3e3939196e6c6cbcae9462dbb617fbfafad2eefdb79cf1a35cf59e000c0e0eb6398e3307800dc3588ac7e343f97cfe5045447684520a376edc6888c56239d334ef13113b8e333734347404c0aee89e00808989093b91488c68ad9f0360d334576a6b6b6f7675759dbd7af56a4b369bdd03f769964aa56a4aa552a2a7a7e7b4699a3f050281452262adf5b3969696e1d9d9596b3bcfdf6b849412f97cfe707d7dfd65cbb21684101eb3d9f6714a44ac94e24020301f8d468bc562f180d7d61fd3516fe5796a6a2a1a8bc5bafbfbfbd75a5b5bd9711c9652b21082038100b7b7b7732a95ba6559d6f1e9e9e9af7692b3157f03db0792af5668686d0000000049454e44ae42608289504e470d0a1a0a0000000d49484452000000300000003008060000005702f987000004e249444154789ced5a5f486269143f5e73c81c064b438c520acbe9123d0c1af36071377ab228528ad0356294a1886259b6b27f46980cb2d4d2d3d09f651ea4c48775d118c6652937651ea6280cb349eebe844f91c43ed5d376f761bdb3d79b5aa67577a003bf07bde73be7f7fbbeebfdce3d9f2c8220201fb6baba8aedececf88f8e8e20168b413c1e878b8b0b401004b85c2e94969682542a85dada5a502a95a052a9d83535355739272608e2ce989b9beb4151d4030078024416c06b6a6ade4f4f4ff7e6c221eb01e170b850afd7cfb2d9ec6806d2781aa4f4451024aad56aeda150e8e9bd0ae8efefff014190289d405151d1416b6beba2d56aedf17abd68241279421f7b787858e876bbeb676666bec5306c85c3e17ca68b62b158b8d16834e75dc0c6c6c673b1581ca425c45b5a5ade3a9d4ec55d977f757515532a954e7a5c9148f4d1e3f1a07911303e3efe8a9ea0a3a3637e7f7fff592ef72e157ebfbf5ca552bda3e7319bcda69c04747575bda104c5a552e9a6cfe793e58b381d0e87e3a54020f844cda9d56aedd748537f57e982b5b6b62e520369349a6b81ee0bb4d5c0d56af5620a01ffae54aa000683c1420d303131f1eaa1c893e8ebeb9ba272d0ebf5b3b71260b7db35d4817373733d0f4d9ec4e0e0e077542e369bad3ba3804020509678be1300800f0f0f0f33459e844ea79b25092308120d0402656905545555fd46926f6e6e5e629a3c098542f1e5512b97cb933742d2696a6aaa8f742a2e2ede659a341d3c1eef20e54e4e3a70b9dc3039fb2b2b2b18d384e9989f9f6f4f598e10040163636326f2627d7dfd2f4c934d07994cf621a580c4e6410000ee72b95e304932432198ba2074b95c2fc80b12896493e959ce50b5a644c1f9f9798950288cc7e371d0e9744ef87fd89fb7f62495fbfdfe72a667ff2e602596edab35846902b9daa300a6ed5100d3f62880697b14c0b47d950282c16019f5f34de56b1298ae7dcc66b30912ddbba5a5a5e60200906521fef655e23dd9dada9a1e0064a7a7a7c0e7f3ff2a48e1c338c974e672b914b158ac1c00a0a4a4e4bcbbbb7b1f80f6822093c93e307d9ba4435d5dddaf099ef8e8e8e86bb292bed6af5f585868679a2c1dcbcbcbcd90785be372b961f2fb5402081e8f77c034613af87cfe2e39c1d456679280eaeaea2faba050289c4c93268161d80a39fb959595bf53af5105e0dbdbdb659413185ca7d3cd3241988aa1a1a161923c8220d1adad2d495a01044180cd66eb86ff3a03f8d0d01063fd51abd5da43e5423677330a2088e4862a00647d6e950fd04e8692daeb370a200802d46a75d201475353d3cf0f45beb3b3f3476aeeb6b6b69fd2f902642813341a8d9d1a4820107c72381c2fef8bb8cfe7934924924d6aceaeaeae3799c6dc18746464e43525200100786363e33bfa8f2917eceded3d6b6f6f9fa7e7999c9cecbb69ecad12783c1e5424127da427502a95ce5c3ad9ebebeb0d2d2d2d6fe971c56271706363e3f96d626495d068349a592c16bd778973389ccf1886ad582c965eb7db5d1f0e870be9632391c813afd78b5aadd61eb55abd9868e727c562b3d9d1818181efb3e194f5ac8542a1a75aadd69ed82ff2f25703369b1d35180c9654c2f32e800a8bc5d22b97cbdf6720970e3800e0288a7a523ddbb3415e7aa3388e23c160f0efdddd5d383e3e86939313383b3b83cbcb4bb8baba022e970b42a1102a2a2a004551686868f8c66432fd91736200f807e3870e82917caa040000000049454e44ae426082'
TUBIAO_add_dependency_button = b'000001000400101000000000200047010000460000001818000000002000be0100008d0100002020000000002000350200004b03000030300000000020007c0100008005000089504e470d0a1a0a0000000d49484452000000100000001008060000001ff3ff610000010e49444154789ca592316e83401045dfe05d132590b880020a4b1444ca3d7292e4189172983496a2dc87134049950285854d61eca03526487c698bfd33fb67e6efc034042049927d9ee74f63ce8577456003a0947a2dcbf27dcc2d1500c05aab8d31930f1709005644ec1a817fa1389ae3b6a9460564b82b2ed129c002c6091800adf537d00c77370700499264af947a11916ddff7a7793dadf54f5dd7cf4dd3ecd234fd6adb760bf443dc02c471fca98220b82bcb32efba7337329c0ed819636eabaa7a1cc63c15b09ee77961183eccd8035996bdf9beff31973367a269db36006ef833d1f5a1bf662203d73bf18bbcd57bb04460d5266e4444cf254c6d171cbf90288a0e6118de174571e65cfc02de0d4cd0b2a8543c0000000049454e44ae42608289504e470d0a1a0a0000000d4948445200000018000000180806000000e0773df80000018549444154789ced544b6a1b4114acd7ef8d460b0983041688398603f622e8165a08ed75066143cea14b84c439c0e81e5a2528445ace263019779737237f148d3d6dbc4b0a1e344c55d7fbf43c200e42522335ade05415e3f1f8d36030f846525a0bdb12cd0caa7a5914c5c727ba578d5a1b9004c952447eb7d54419d490584dac4134fe1bb43670781ce0c928cbf22199c562d1c83bba4b040054156606928d99a4698ae170f879bbdd5e264932f6de3772450421045455059b4c26b6d96cae55f522847027227fb58d245435ecf7fb2beffdd96834ba1591a66c084001fc9c4ea737369bcd64b95c5e14457125227fd03c97e0bd3f23e976bbdd071169fa8b49d27abddef76eb79b4244606658ad5609493d15f5379765d9ad99fd229990d43ccfed143fcf73538ddc899d4e0759967d31b35dc4b27bd66f7921b42ccbc319ebf55af1e4a5bc10cdafe608aeaee06b5dc1a1fef7dba66fc5bf6740440cee2d069d10421a23b0b6c47a4ffde8f7fbe700c27b1bb0aa2acce7f36be75cd7397768d3abedba079d54aaf4b10e738b0000000049454e44ae42608289504e470d0a1a0a0000000d4948445200000020000000200806000000737a7af4000001fc49444154789ced97cf8ed25014c6bf73a77fa0e81009dc0d26d5480c9b2e0c0dfa107d83d9b2f619c0956fe043b8702b4f40e24e37c6181316ac089381480c84723f17d0499d8cb40c7188095f72927b7b7beef9dd736f4f5be03fd51949d15a5fd4ebf51ec9020090947f1e390942b2acb5fee4380e8320789580ed3b9fdad7a1dbed26ab14634c71b55a99c964b277e03b03dc104544d9b6cd63011cbce787021cac13c009e0e80056d22029a922b34b8a24f1e7232824250c43154551ae9ad0ebf508e0fadebd3341f241b55afda29462a55279b9af7fa2240386e43936b53c6b050ac01ac023638c4d1261189ef7fbfd87009cedd82e0900148bc5abc562b1e968ad2f00bc26e9dd92dedb640038d3e9f4691cc76eb95cfee1baee4f638c95e10711310094e7791f86c361d70200dbb69f8fc7e3761cc710c9575d8d3149733d9bcd9e29957f1745049ee77d0350b00060341abd0d82e0e3e5e565e68bc5b22c89e398cd66b334180cdecde7f3275aeb8eebba5f49aaed0affaa388e592a95ec76bbfd5d447ee5a6be299256ad56fbac9462a3d17871d77992bc09360730d35aad96bd6d97499e01c072b92c6daf3979e749622700c4e6f4665a1445e93e81eb8395cb3f65260d70349d004e0027804301ccd68e02c0f57a5d24a90a85c2fd6532f56f28beefbff17dff7da7d3799c1ebb57189299df00bbf41b6347d73aab1a3be70000000049454e44ae42608289504e470d0a1a0a0000000d49484452000000300000003008060000005702f9870000014349444154789ced98bd6ac3301446bf14534a566d1e0a361d4b404fd017c8e22d53f6eeee684ff6e2cd2f6267f7e4b14b08dd4aa2c50fd051c693ba28fd990a8d958be01e105c81d1d54178f8eec218039fb9a1bec0a5381588e3b80b82e0bdaeebb5b326c61827ab288a0d802300138661efaa8fb31798a6e916c083adef5cf5e17f801a16a08605a861016a58801a16a08605a861016abc17087e6ecab2dcd82475317ddf3f9d6badf532cff3ed1ce7028094f29024c91b80ef4c1c4551079b613d58c7a66956bf32f1300cf7b019d607945231002cce83adbaaed75555bdcc15c0b5d6cb711c1fedf62484f898e35c009052eebbae7b06e06eac9265d916f6c98510afde8d55ae050b50c302d4b000352c400d0b50c302d4b000352c408df702c1df9ffc0f29e501c0c9d67b577dbe42bd0bdab65d29a5e2344d77ae7a3815b8069fe9b69066c4d62a9f0000000049454e44ae426082'
TUBIAO_remove_button = b'000001000400101000000000200087000000460000001818000000002000bd000000cd0000002020000000002000d20000008a0100003030000000002000d60000005c02000089504e470d0a1a0a0000000d49484452000000100000001008060000001ff3ff610000004e49444154789cedd0a11280300c03d0d055d63064bf989f45b5aeeb30380c3bc4cc9ecf251760f96d03c07317a8ea19113533dbb3e88b4e4485992f76f7ddcc0e006db0bc88481fccbccd3f71016ec98b11ecbb09b95b0000000049454e44ae42608289504e470d0a1a0a0000000d4948445200000018000000180806000000e0773df80000008449444154789cedd2210e03211085e1f7188227c12ca2bd1307e54ef52458420ab3666baad99af299717f329301b66de3d75c4d01c0dc14070043118188405541ae59e4d31a63c0c61873effd39e71c58772a35c68873ee655b6b4729e541f2adaa4bea24a1aa3684d02922482939effd9afaa5d6ca9c7307eefb2000e04fde74dbfedd09ac832b3a082d1aeb0000000049454e44ae42608289504e470d0a1a0a0000000d4948445200000020000000200806000000737a7af40000009949444154789cedd1210e02311085e1791bd29a0645900dba92bbf400353dd49a1ea0be9720415673839a0dc956b02b402056cf92309f19f9bf6488841042fc3b1011bcf783736ee10cd75a91737e713637416b4d314637cf33eb1aadf5308e6385b5f6364dd36579638903200030c63c0ebdf7736bedc415ff1ea1947aa294720c215cf778414ae9ced9dc04221a3e770fbc7f174208f1935609f231641646517a0000000049454e44ae42608289504e470d0a1a0a0000000d49484452000000300000003008060000005702f9870000009d49444154789cedd8b10d0321100551385de40c5304a95b233f4726a710baa10f9612700d96658f90fe93c877d046ebd75a6e67073dc0b7144053004d013405d0144053004d013405d014405300edecbddf4a29cf31c69d1ee6133146bbaeebe5524acb39b7e54b29adc3cc7ef1417f6166ceb7d61e39e73ae7dc6a854208566bcd5e97399802680aa02980a6009a02680aa02980a6009a02680aa0bd01d79e51571dd2d2260000000049454e44ae426082'
TUBIAO_undo_remove_button = b'000001000400101000000000200066010000460000001818000000002000b3010000ac0100002020000000002000670200005f030000303000000000200009020000c605000089504e470d0a1a0a0000000d49484452000000100000001008060000001ff3ff610000012d49444154789c9552cd4ac340189cd9ad013195044ad29f5de8a9cf9097f0187c06f15c14bc684110c43750f0e6cd370af4e003d882c921249f8726c5da689381efb23b33cc7c7cc0dfe03f7f07410088a2e8f8105135083549b1d62e56abd559f5aedb181080225918636e8ba270822078af38659bc89a24acb577c3e1f08164fd7e70175bb131e63e0cc3a74aec0038aae2f77ecd4e25a594c2743a9d4f2693ab4adc1a544a613018dca4697a1904c122cbb2539202401af8a294d28ee37c2449f246527a22021159e7795e2c97cb7559965f35b9c90080f67dff73af82b5f6c2f3bcc7ae156a6892188d46d7aeebbec671acb15960bdc4a6d9438f24c6e3f1dc75dd971f493a45da9af4fbfde7300c4fb039a4ee26c698f96c363baf2b76310036270d11e92cdc316943fa06e9ca4377debd7d1a0000000049454e44ae42608289504e470d0a1a0a0000000d4948445200000018000000180806000000e0773df80000017a49444154789cd595b14ac3401cc6bfbb5c84347a945c49a101d3a99be81bf42932770c143a74ea249d55f401dcba3928882f1037ebe06071e8e20b98ae9982fd3b7891425b699a46f0836f0977bf8fffdd170ed85c2cc7dadce2a5c38988b5db6db1d5e6750a82c00030ef743acd46a311b9ae7b0c00c3e1b0f8441a8e6eb7eb2ba5269ee75d1091c0f75d14bb8f0c1e86615329f5ea79de99103fa7b353f86401ceff1dfc5cc38dc2f0ac156118361dc779abd7eb979c73003001081db2a9971ac6006030181cd66ab549abd53ab52c0ba6696ee595f0d168a47abd5e9424c991ebba3744945591721ccf9c31664a299fa6d3e915638ca0c7679cf394883e0060369bbda769faa9c1f31c0104c01442c442085a9a228ee303c7711ea594d759e719631b3b5bbf4e1c00c6e3b19452bed8b6fda043f6b4450e1b2b13b22611915dad569f6ddbbedbd93ff05b886118e586542a953f0d419921f7fd7edf4219934451b4effbfe6d1004278bdf772506000bef41292afe8a95a52fcdf3801803bbd5920000000049454e44ae42608289504e470d0a1a0a0000000d4948445200000020000000200806000000737a7af40000022e49444154789ced563b8c125114bdf7cd7d4fb3926122a180868466f824509221013a233fa9a8ec69ecd62dec6874d7ce9ac268678326c6d6123a3a4a0b120b36768b10b3109c6be10c4edc251b779921317b925bcde49edf9b0fc02dae07dc2bbb10023a9d8e0c949499110084520a72b9dcb3582cf69999ef7baef90a0400945242a15038544a7dcf6432cf2793c9dd6eb72bc0cf4a1c779a52ca259fa552a9175206d3c0c679b1583c544a9d99a679cccc020084afd17b9d5b96f5542935334df3d8e3dcd7de37cebde4ae73a7777ff057e72ef989e31c2128e71ef2e09d5b9675a4949aa5d3e9974a29803f070e99f9da73a508a7f323223a4b269327ae736776810b7bdc4e9199b152a93c190e87afb2d9ecebe974da592e9720c4ee529fcfe760dbf6050142d334bb542a3d1e0c066fd6eb358542a12f52ca05222a00b02fddf6efe0783cfe693c1e771171b3930000981910f194997f004078b55a7d5d2c16a700a0ed48800d00771289c43729e5a5fb504a09ad56ab26a59c47a3d177cee10344bcf1b87bae82464450abd5ea44b40c87c31f7bbdde01002867e8a6d36eb7b5adec8e42414450afd76b44f4d3308c0f9ec727b09f10222268369b0f89e8dc308c3e334bd8ede3b81dde241a8d4695886cc330dedf264144b6aeebfda03ec75e6c9290529eebbabebf24aad5aa7b26fa44b4b9c577110ec8a9e301112d2391487f341a1dc0ef14fc17e14da25c2e3fcae7f36f99f99e7bd977011e0844044ddbfe520b44c45ed9ff2bfc0231c8edc7950b22730000000049454e44ae42608289504e470d0a1a0a0000000d49484452000000300000003008060000005702f987000001d049444154789cedd9b14ec2501406e043698c8c5da46cc4f8001d8d88a1f0026e8c6d61627730842720e1018c09e5c2ca0b30376e262e90407070e50d1c4c8f8b9a8296b6f4ca3d37e99fdc85de9efc5f8184961c2282cc514417489b0c203a194074b8033a9dce5d3e9f5f0d06835bdeb3ff8aca7358abd5eabaaeeb00006c369b339eb34383885c96e3385d005803c0bad1683cf09a1bb5a42ecf0520b27c6a806ddbbdeff2f57afde8e5530128943f1840a5fc41004ae513032ccbfa296f9ae6a3e8f2890014cbc706502d1f0b40b97c242058be56ab912bbf172043f95040a03c522e8f889043dc7e2a61db768f316601c085a669d0eff7cd42a1f0fe7fbf87f74755d58f66b3f91cba21a8190e8737f075e509ad75a5526161efc0d60d4db95c7e5314c5f77d3ff8f26bf2ebc6378661bc841edc158d46a36b45515600809aa6a1e779bae8cf79e22f7110512c169fe6f3f9a9e8a289003221f61e648c5d5147446e0822745df7a821626da28c88bd912a22d1668a88c4278cc7e32dc462b138910a400d71f0895410a94ea680483d208828954a4747701932994c2e4521b80dda452c974b552ac02ea2dd6edf4b074044984ea746b55a7567b3d9f93100bfee89654bf62fa5e86400d1911ef009e5d2ea3bfb2ad95a0000000049454e44ae426082'
TUBIAO_run_pyfile = b'0000010004001010000000002000b1010000460000001818000000002000bc020000f70100002020000000002000d8030000b30400003030000000002000450400008b08000089504e470d0a1a0a0000000d49484452000000100000001008060000001ff3ff610000017849444154789ca593bd4a03411485efccce2e9b9db990617689a60821cd5a6c0ad3442461439ec0522c22e41df425acb534a0a095a2750ac1bc420a7f204108419b3c81ebd86c64099b4d82a7be7cf7ccdc73a0d7ebd9aeebdee7f3792da5bc0ac3708b1002b10c582521c401e7fcb556abed09216e72b9dc8752ea74381c5af10801009ac5e822e213630c28a5502e9743447c761ce7cdf3bc0e632ce92615d441c481d6da00001300803106aeeb1e3a8ef382888352a9d4360c23092249c031220e4cd38478039d0f68ad9952eac4b6ed09e7fca15aadfa94d22428d5d20f006800300821dfb3d9ecacd56aed32c6a6a3d1a88f88e76118ba0010cd172d3a488afc6da2148220d8e19c3fdab6fd592c16bbf36765015241beefef0b21be0a85423bf33cebea5f4fc8726000802684448d46c343c48bf178dcb72c6b52afd783e9747a194551ea2726cf68ae3a23c0922029a58ee641aa542a99415a16e5f7b5a2bc50a6db8dcb14d7f94e4aa9a594d7cd66737b933aff02495f6adad04d905a0000000049454e44ae42608289504e470d0a1a0a0000000d4948445200000018000000180806000000e0773df80000028349444154789cad56cf4b1b41147e3b336f06766389bbd10d89ee9ac2c6835e765708968207237816bc04d25fdefd072cc442cfedd9865ad2738b2dc4530feda550698ab79e052f3d08622105a1e9eb65b35d7fd49a6cbff3ccfbdebcf7bdf70d00005b5f5fb74ba5d2874c2643b66defcfcfcfdfe29c43040e001a0c0b2104e4f3f96d00f8592814de20e2374424cbb29aababab25c6583aa246a3211863c7131313af0cc3807abdeed8b6fd444a494aa9eed4d454a3d96c9a9a16c7e657c5bb80300c11008e8bc5e20b22d200001863b0b8b8e89ba6f9161149d7f5c372b9bc4644fde76800c0fe1af4328242a1f012110100b09fa59412c2305c320ce3a310820cc3e8f8bebf2ca5ec5f67ff244a10b422827e095894294829a15c2ed7755d3f104290699abbd56a75ee5a42b882207919344d839d9d9dacebba1b4aa91344a45c2eb755abd5dc73421898e0cc65c618d46a353797cb6d454238715d77a3dd6e8f5e2a840108202a030700e09cc3c2c2c29c699abb4208d275fdc0f3bcbb4aa9e4d98109fa889b2ba504dff7970dc3f81c0961af52a92c45fdd18625481269000044c4a6a7a71fe8ba7e88881404c13dcef9d02f388f580847474737b2d9ec17443c20227ebd614981b404fd12f58888799eb7e638ced76eb71bcccece3e1242f444cac47e4929616666663993c93c3e3d3d0d95527b4110dcef743aef7abddec04d3e23d36ab5fa5f657a61d010919452df1dc7799866d06285b4dbedd1e4aab02ceb599a55116b5c29059ee7dd49bbecae5ad79f52afeb62b1b87d99e1440d1cde701296f93a61994fa34df963727272b3d56a59435b66d2f4f3f97c6cfa636363cf5756566ea6367df8f36d793f323242e3e3e3fb954ae5b610f10ca6fab6fc06b0e3cfda214b7d250000000049454e44ae42608289504e470d0a1a0a0000000d4948445200000020000000200806000000737a7af40000039f49444154789cc5574f4c236514ffcd377f5266ccf0b1144868e89fa99632cdaa94624269da4c50488a8413844a253431929806ff6dd08be1c081c46e16ae5c964d563d70c6c81ab3f73511a30777f562b267ec668d878dd13e0f9d294351047706df6df27deffb7ef3bddf7beff700dbaad56a2c9d4e1f72ce29140a3d29140a6f1091662f0b0044f86507070757babababe0640922411000240c160f02bcbb28aa2d8ba9bd960bcb5743afd3600e29cdf5b5d5d2d2693c9f73a3b3b7f0040a228522412b93d3535955614c50d8479064096e52d008df1f1f10f05a1f983d56a359648243e5214e511000a040275c3306e6c6e6e1ace8bcccdcd7913164110b601d0f0f0f01a1131000a00489284e5e5e5abe170785796e5df0190a6690f53a9d4dacece4ed0758488a7098d03606464644d92240060ebebebad670e040228168b565f5fdfe78cb13f0190aeebdf8d8e8e2edb800100b68f3700da0e15008088d8d8d8d8eb9cf3bb008831d6e8ededbd333939f98aaaaa8e0bbb3090b300385be07ae6bdbdbd2ba669beab69dacf6866ce1f030303b7171717d3b63f0048386f58ce01a0650ef14451c4f6f676381e8f7fdcd1d17104801445796c18466d696929ee72f9f7d4bd0800c7c5d9a3280aa6a7a75f8846a3bba228129afcb86f9ae6fb4747473a63cda3ce0ccb7f00700a882449b02c6b32180cde0140822010e7fc309fcfbf46444afb7eaf0038d6e2071105b2d96c99737e280802098240dddddd5f4c4c4cbcdc56513d0500e0f8991963a8d7eb9d838383d7745dff1176458d46a3bb333333cfdb771cf3c22b00ce716eff52a9f49c6118376459fe1500a9aa5acfe5726fb9b2c573006e2012d0e4c7fcfcfc682814fa0ccd6cf9ad52a914fc0600a0151606009aa621994cde443353ae7b7ad145add1681c7f5c46084aa5d24b97158253248cc5625b2e12fee21b09dbd3309148ace9bafe138ed3f0e6ececec553fd2f04421cae57265cef9b7975188feb7527ca219158bc5172391c82d57337a30343474cd9766e46ec7b55a2d621846cd69c7b22c3f360ce37ab95c7ed6e5e2493b3e2148f6f7f7bb52a9d43b6d82e4938585858ce782a45d9265b3d9b2aeeb87b025594f4fcf97be48b27388d2ef33994c85885ad47e6a517a862cbfe5c87255551f9aa6f981a7b2fcef06934aa562b40d268f62b1d8d6c6c646dcf3c1e41f46b3fbb02b58381cfed4b2ac11df46337b38bd87d3c3e9dd42a1f0aa8bd9fe0ca700b0b2b212cd6432df70cea9bfbfff493e9f7f93889eb1977d1bcfff02a851677c2155692c0000000049454e44ae42608289504e470d0a1a0a0000000d49484452000000300000003008060000005702f9870000040c49444154789cd59aff4b22691cc79fc6b1e41acdec82256c9245ee97c80a6513b98efda52014d225e5a88ba0ae2f6e2a2a3b06c77174912e383fd872c8fd6254c6298bed0ff7435c61ab1706574488e536a4f7bf3cfbc3f62c398e12b4ed3c0ebc611e9d19df2f9f799e793e9fcf000821b8abe3e3e3aef1f171a856ab214551d06432c1edededeff9c7e1a28ac6fafafa8f4d4d4d650000e4a9acd3e9de1d1c1c68c5365c132093c9d035cc57808c8d8dfd512814be11db7815c0e8e8681419254992f3783c9e4020b0d0d9d9f91f00a0028c20889bf9f9f980d8e62b00542ad51932c830ccc2dd835656567e96c964573c90324551f9b5b5b5492c00ee9adbdada121cb4535353bff37b03005056abd5d95ae78802506fd6393d3dfd767878784b0864707030757474a4c11a00696f6f6f40abd5fe230462b15822c56251863500d2c6c686a5a3a3e38c0f2291486e9c4ea71f7b0024bfdfffb2b9b9f9037fa02b148a8b5028e4c01e00c9e17004856e2b9aa6dfc7e37113f6001042707272f2c46834ee0a81180c8664369b55630d80944c260d1a8d262d0462b55a598ee348ac01905896b52a95ca733e0849929cdbedf6600f80e476bb3d244972fcde502a95e7e170f805f6001042c0711c69b3d958a1db4aa3d1a41389c433ac0190b2d9acda6030248540868686fecae5724fb00640dadddd35f6f4f4bc1702999898785d2a9508ac019042a19043a1505cf041a45229e7f57a5dd80320399d4ebf4422b9e1f7467b7bfb79341a1dc51e0042088ac5a2cc62b144846eab9999995fb107404aa7d39a818181147f7d7537f6c01a0029168b3d6f6969f980fce9f5fab7e83b0234c0363737f72fc3302c6a5f5e5eead07e4300d4db1a0220168b3d67599641edbebebe4bb44f8a63e97e5b3a9d7eca300c5b2814740000ededc7ff2f2f2f473f1f84e3202e168b32b3d9fc06084ca3d3d3d3bf613d8d2e2d2dbd127a90a954aa33ac1f64c160d02197cbf3fc7f5d2a95723e9fef65adf3440788c7e3269aa605177376bb1ddfc55cc32ea7398e23ad566b6306342e97cb2b1452b6b5b55d601d5286c3e117b5827a97cbe57dc8b51f152091483cab9756b9bebe6e7ee86f3c0a402e97ab99d8d2ebf56f33990cfda57af78b02944a25c26eb7bf1632dedddd9dddd9d9c137b5e8f3f95072b7c2b85c2ecf0783417c93bb9148c4725b9eaa4aaf2f2e2ebe7a2ce30f0648a552350b1c66b3f9cdd5d5159e058e7a25a6fefefe778787874fbf86f1ba00b50a769393938245beaeaeaee3cdcdcd1fbea6f12a807a65d64020b0701b545764075a5b5b0bababab3f8961bc0a805fe876bbdd750bddb3b3b3bf8869bc0ae0beaf1a8c8c8cfc99cfe729b18d570140f8e9650f8220f8d1100400947b7b7bffdedfdfff4e6cc3750120fc54dfb2d96c90a669485114341a8d50ac017a1f7d04017533a878291e560000000049454e44ae426082'


class DebugPage(QWidget):
    # 调试窗口页面
    def __init__(self, main_window_instance):
        super().__init__()
        self.main_window = main_window_instance
        self.deleted_dependencies = []
        self.current_directory = ""
        self.backup_folder = os.path.join(os.path.dirname(os.path.abspath(__file__)), "依赖库文件备份")
        self.config_file = os.path.join(os.path.dirname(os.path.abspath(__file__)), "deleted_files.json")

        # 创建调试页面的UI
        self.init_ui()
        self.setWindowTitle("环境调试窗口 - by bilibili爱吃肉的呆头猪")

        # 设置窗口图标
        icon_data = bytes.fromhex(TUBIAO_windows)
        pixmap_windows = QPixmap()
        pixmap_windows.loadFromData(icon_data)
        self.setWindowIcon(QIcon(pixmap_windows))

    def init_ui(self):
        # 添加垂直布局
        layout = QVBoxLayout()

        # 添加虚拟环境文件夹编辑框
        self.virtualenv_folder_edit = QLineEdit(self)
        self.virtualenv_folder_edit.setPlaceholderText("请选择虚拟环境目录路径")
        layout.addWidget(self.virtualenv_folder_edit)

        # 添加选择文件夹按钮
        self.select_folder_button = QPushButton("选择虚拟环境文件夹", self)
        self.select_folder_button.clicked.connect(self.select_virtualenv_folder)
        layout.addWidget(self.select_folder_button)

        # 添加镜像源标签
        self.mirror_label = QLabel("镜像源:", self)
        layout.addWidget(self.mirror_label)

        # 添加镜像源编辑框，并设置默认内容
        self.mirror_edit = QLineEdit(self)
        self.mirror_edit.setText("https://pypi.tuna.tsinghua.edu.cn/simple")
        layout.addWidget(self.mirror_edit)

        # 添加是否使用镜像源复选框，并设置默认勾选状态
        self.use_mirror_checkbox = QCheckBox("使用镜像源", self)
        self.use_mirror_checkbox.setChecked(True)
        layout.addWidget(self.use_mirror_checkbox)

        # 添加列表显示框
        self.dependencies_list = QTableView(self)
        self.dependencies_list.setSelectionBehavior(QAbstractItemView.SelectionBehavior.SelectRows)
        layout.addWidget(self.dependencies_list)

        # 创建水平布局
        button_layout = QHBoxLayout()

        # 添加刷新依赖库按钮
        pixmap_refresh_button = QPixmap()
        pixmap_refresh_button.loadFromData(QByteArray.fromHex(TUBIAO_refresh_button))
        self.refresh_button = QPushButton("刷新", self)
        self.refresh_button.setIcon(QIcon(pixmap_refresh_button))
        self.refresh_button.clicked.connect(self.refresh_dependencies_list)
        button_layout.addWidget(self.refresh_button)

        # 添加依赖库按钮
        pixmap_add_dependency_button = QPixmap()
        pixmap_add_dependency_button.loadFromData(QByteArray.fromHex(TUBIAO_add_dependency_button))
        self.add_dependency_button = QPushButton("添加", self)
        self.add_dependency_button.setIcon(QIcon(pixmap_add_dependency_button))
        self.add_dependency_button.clicked.connect(self.add_dependency)
        button_layout.addWidget(self.add_dependency_button)

        # 添加删除按钮
        pixmap_remove_button = QPixmap()
        pixmap_remove_button.loadFromData(QByteArray.fromHex(TUBIAO_remove_button))
        self.remove_button = QPushButton("删除", self)
        self.remove_button.setIcon(QIcon(pixmap_remove_button))
        self.remove_button.clicked.connect(self.remove_dependency)
        button_layout.addWidget(self.remove_button)

        # 添加撤销删除按钮
        pixmap_undo_remove_button = QPixmap()
        pixmap_undo_remove_button.loadFromData(QByteArray.fromHex(TUBIAO_undo_remove_button))
        self.undo_remove_button = QPushButton("返回", self)
        self.undo_remove_button.setIcon(QIcon(pixmap_undo_remove_button))
        self.undo_remove_button.clicked.connect(self.undo_remove_dependency)
        button_layout.addWidget(self.undo_remove_button)

        # 添加运行文件按钮
        pixmap_runpyfile = QPixmap()
        pixmap_runpyfile.loadFromData(QByteArray.fromHex(TUBIAO_run_pyfile))
        self.run_file_button = QPushButton("运行", self)
        self.run_file_button.setIcon(QIcon(pixmap_runpyfile))
        self.run_file_button.clicked.connect(self.run_python_file)
        button_layout.addWidget(self.run_file_button)

        # 将水平布局添加到垂直布局
        layout.addLayout(button_layout)

        # 添加安装本地whl文件按钮
        self.install_whl_button = QPushButton("安装本地whl文件", self)
        self.install_whl_button.clicked.connect(self.install_whl_files)
        layout.addWidget(self.install_whl_button)

        self.show_files_button = QPushButton("高级功能（模块文件删减）", self)
        self.show_files_button.clicked.connect(self.show_dependency_files)
        layout.addWidget(self.show_files_button)

        # 设置布局
        self.setLayout(layout)

    def install_whl_files(self):
        # 安装whl文件按钮事件
        try:
            # 打开文件选择对话框，允许选择多个文件
            file_dialog = QFileDialog(self)
            file_dialog.setFileMode(QFileDialog.FileMode.ExistingFiles)
            file_dialog.setNameFilter("whl Files (*.whl)")
            if file_dialog.exec():
                selected_files = file_dialog.selectedFiles()
                virtualenv_path = self.virtualenv_folder_edit.text()
                if not virtualenv_path:
                    QMessageBox.warning(self, "警告", "请选择虚拟环境文件夹")
                    return

                activate_command = (
                    f"{virtualenv_path}/Scripts/activate"
                    if sys.platform.startswith('win')
                    else f"source {virtualenv_path}/bin/activate"
                )
                for file_path in selected_files:
                    install_command = f"{activate_command} && pip install {file_path}"
                    # 使用 Popen 执行命令，并捕获标准错误输出
                    process = subprocess.Popen(install_command, shell=True, stdout=subprocess.PIPE,
                                               stderr=subprocess.PIPE)
                    stdout, stderr = process.communicate()
                    # 如果发生错误，则显示错误消息
                    if process.returncode != 0:
                        QMessageBox.critical(self, "错误", f"安装本地whl文件时出错: {stderr.decode()}")
                        return
                    QMessageBox.information(self, "成功", "成功安装本地whl文件")
                self.refresh_dependencies_list()
        except Exception as e:
            QMessageBox.critical(self, "错误", f"安装本地whl文件时出错: {str(e)}")

    def run_python_file(self):
        try:
            virtualenv_path = self.virtualenv_folder_edit.text()
            if not virtualenv_path:
                QMessageBox.warning(self, "警告", "请选择虚拟环境文件夹")
                return

            # 获取 Python 文件路径
            python_file_path = self.main_window.py_file_lineEdit.text()
            if not python_file_path:
                QMessageBox.warning(self, "警告", "Python文件路径为空")
                return

            activate_command = (
                f"{virtualenv_path}/Scripts/activate"
                if sys.platform.startswith('win')
                else f"source {virtualenv_path}/bin/activate"
            )
            run_command = f"{activate_command} && python {python_file_path}"

            # 使用 subprocess.Popen() 执行命令，并捕获标准错误输出
            process = subprocess.Popen(run_command, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
            stdout, stderr = process.communicate()

            # 检查是否有错误输出，如果有，则显示错误信息
            if stderr:
                error_message = stderr.decode('utf-8')
                QMessageBox.critical(self, "错误", f"运行Python文件时出错: {error_message}")
        except Exception as e:
            QMessageBox.critical(self, "错误", f"运行Python文件时出错: {str(e)}")

    def toggle_top(self, checked):
        if checked:
            self.setWindowFlag(Qt.WindowType.WindowStaysOnTopHint)
        else:
            self.setWindowFlag(Qt.WindowType.WindowStaysOnTopHint, False)
        self.show()

    def select_virtualenv_folder(self):
        # 选择虚拟环境文件夹的代码
        try:
            folder_path = QFileDialog.getExistingDirectory(self, "选择虚拟环境文件夹", "")
            if folder_path:
                self.virtualenv_folder_edit.setText(folder_path)
                self.refresh_dependencies_list()
        except Exception as e:
            QMessageBox.critical(self, "错误", f"选择虚拟环境文件夹时出错: {str(e)}")

    def refresh_dependencies_list(self):
        # 获取依赖库按钮事件和页面的列表
        try:
            virtualenv_path = self.virtualenv_folder_edit.text()
            if not virtualenv_path:
                QMessageBox.warning(self, "警告", "请选择虚拟环境文件夹")
                return

            # 构建 pip list 命令
            pip_list_command = [f"{virtualenv_path}/Scripts/pip", "list"]
            # 使用 Popen 执行命令，并捕获标准输出和标准错误输出
            process = subprocess.Popen(pip_list_command, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
            stdout, stderr = process.communicate()

            # 如果发生错误，则显示错误消息
            if process.returncode != 0:
                QMessageBox.critical(self, "错误", f"获取依赖库失败，错误信息: {stderr}")
                return

            dependencies = stdout.splitlines()

            # 创建一个标准项模型
            model = QStandardItemModel()
            # 设置列标签
            model.setHorizontalHeaderLabels(["依赖库", "版本号"])

            for dependency in dependencies:
                dependency_info = dependency.split()
                dependency_name = dependency_info[0]
                dependency_version = dependency_info[1] if len(dependency_info) > 1 else "Unknown"

                # 添加依赖库名称和版本号到模型中
                item_name = QStandardItem(dependency_name)
                item_version = QStandardItem(dependency_version)

                # 将项添加到模型中
                model.appendRow([item_name, item_version])

            # 将模型设置到表视图中
            self.dependencies_list.setModel(model)

            # 设置水平表头和垂直表头的调整模式
            header = self.dependencies_list.horizontalHeader()
            header.setStretchLastSection(True)
            # 设置列宽度
            self.dependencies_list.setColumnWidth(0, 250)

        except Exception as e:
            QMessageBox.critical(self, "错误", f"获取依赖库列表时出错: {str(e)}")

    def add_dependency(self):
        # 添加依赖库
        try:
            dependency_list = [
                "numpy", "pandas", "pygame", "matplotlib", "scipy", "scikit-learn", "tensorflow", "keras", "keyboard",
                "torch", "opencv-python", "seaborn", "requests", "beautifulsoup4", "flask", "django", "sqlalchemy",
                "pytest", "pytest-cov", "pytest-html", "pytest-xdist", "selenium", "pyqt5", "pyqt6", "pyside6",
                "pyqt5-tools",
                "pyqt6-tools", "wxpython", "tkinter", "pyyaml", "pyqtgraph", "pillow", "pyinstaller", "cx-freeze",
                "pylint", "flake8", "black", "mypy", "pytorch-lightning", "fastapi", "uvicorn", "starlette",
                "sqlalchemy", "asyncpg", "aioredis", "aiosqlite", "django-rest-framework", "marshmallow",
                "mongoengine", "redis", "celery", "pytest-asyncio", "httpx", "aiohttp", "pydantic", "fastapi",
                "jinja2", "uvicorn", "starlette", "dash", "plotly", "bokeh", "streamlit", "pytz", "arrow", "pendulum",
                "dateutil", "python-dateutil", "flask-restful", "pyjwt", "itsdangerous", "bcrypt", "passlib",
                "cryptography", "paramiko", "fabric", "pexpect", "awscli", "boto3", "gspread", "openpyxl", "xlrd",
                "xlwt", "pyodbc", "pymysql", "mysql-connector-python", "psycopg2", "python-ldap", "watchdog",
                "pyinotify", "click", "fire", "docopt", "typer", "clint", "prompt-toolkit", "tabulate", "rich",
                "colorama", "termcolor", "nuitka"
            ]
            # 创建带有自动补全功能的 QLineEdit
            completer = QCompleter(dependency_list, self)
            dependency_input = QLineEdit(self)
            dependency_input.setPlaceholderText("指定版本例如：nuitka==2.0.1")
            dependency_input.setCompleter(completer)

            # 创建对话框
            dialog = QDialog(self)
            dialog.setWindowTitle("添加依赖库")

            # 添加垂直布局
            layout = QVBoxLayout(dialog)

            # 添加标签
            label = QLabel("输入要添加的依赖库名称：", dialog)
            layout.addWidget(label)

            # 添加编辑框到垂直布局
            layout.addWidget(dependency_input)

            # 创建按钮盒
            button_box = QDialogButtonBox(QDialogButtonBox.StandardButton.Ok | QDialogButtonBox.StandardButton.Cancel)
            button_box.accepted.connect(dialog.accept)
            button_box.rejected.connect(dialog.reject)

            # 将按钮盒添加到垂直布局
            layout.addWidget(button_box)

            # 执行对话框
            if dialog.exec() == QDialog.DialogCode.Accepted:
                dependency_name = dependency_input.text().strip()
                if dependency_name:
                    virtualenv_path = self.virtualenv_folder_edit.text()
                    if not virtualenv_path:
                        QMessageBox.warning(self, "警告", "请选择虚拟环境文件夹")
                        return

                    activate_command = f"{virtualenv_path}/Scripts/activate" if sys.platform.startswith(
                        'win') else f"source {virtualenv_path}/bin/activate"

                    if self.use_mirror_checkbox.isChecked():
                        mirror_url = self.mirror_edit.text()
                        install_command = f"{activate_command} && {virtualenv_path}/Scripts/pip install -i {mirror_url} {dependency_name}"
                    else:
                        install_command = f"{activate_command} && {virtualenv_path}/Scripts/pip install {dependency_name}"

                    # 使用 Popen 执行激活虚拟环境的命令
                    subprocess.Popen(activate_command, shell=True).wait()

                    # 使用 Popen 执行安装依赖库的命令
                    subprocess.Popen(install_command, shell=True).wait()

                    QMessageBox.information(self, "成功", f"成功添加依赖库: {dependency_name}")
                    self.refresh_dependencies_list()
        except Exception as e:
            QMessageBox.critical(self, "错误", f"添加依赖库时出错: {str(e)}")

    def remove_dependency(self):
        # 删除依赖库
        try:
            selected_index = self.dependencies_list.selectedIndexes()
            if not selected_index:
                QMessageBox.warning(self, "警告", "请选择要删除的依赖库")
                return

            selected_row = selected_index[0].row()
            model = self.dependencies_list.model()
            dependency_name = model.item(selected_row).text().strip()
            self.deleted_dependencies.append(dependency_name)

            virtualenv_path = self.virtualenv_folder_edit.text()
            if not virtualenv_path:
                QMessageBox.warning(self, "警告", "请选择虚拟环境文件夹")
                return

            activate_command = f"{virtualenv_path}/Scripts/activate" if sys.platform.startswith(
                'win') else f"source {virtualenv_path}/bin/activate"
            activate_process = subprocess.Popen(activate_command, shell=True, stdout=subprocess.PIPE,
                                                stderr=subprocess.PIPE)
            activate_process.communicate()  # 等待命令执行完毕

            uninstall_command = [f"{virtualenv_path}/Scripts/pip", "uninstall", dependency_name, "-y"]
            uninstall_process = subprocess.Popen(uninstall_command, shell=True, stdout=subprocess.PIPE,
                                                 stderr=subprocess.PIPE)
            uninstall_process.communicate()  # 等待命令执行完毕

            self.refresh_dependencies_list()
            QMessageBox.information(self, "成功", f"成功删除依赖库: {dependency_name}")
        except subprocess.CalledProcessError as e:
            QMessageBox.critical(self, "错误", f"删除依赖库失败，错误信息: {e.stderr}")
        except Exception as e:
            QMessageBox.critical(self, "错误", f"删除依赖库时出错: {str(e)}")

    def undo_remove_dependency(self):
        # 返回按钮事件
        try:
            # 获取最后一个被删除的依赖库名称
            if self.deleted_dependencies:
                dependency_name = self.deleted_dependencies.pop()
                # 重新安装依赖库
                virtualenv_path = self.virtualenv_folder_edit.text()
                if not virtualenv_path:
                    QMessageBox.warning(self, "警告", "请选择虚拟环境文件夹")
                    return

                activate_command = f"{virtualenv_path}/Scripts/activate" if sys.platform.startswith(
                    'win') else f"source {virtualenv_path}/bin/activate"

                if self.use_mirror_checkbox.isChecked():
                    mirror_url = self.mirror_edit.text()
                    install_command = f"{activate_command} && {virtualenv_path}/Scripts/pip install -i {mirror_url} {dependency_name}"
                else:
                    install_command = f"{activate_command} && {virtualenv_path}/Scripts/pip install {dependency_name}"

                activate_process = subprocess.Popen(activate_command, shell=True, stdout=subprocess.PIPE,
                                                    stderr=subprocess.PIPE)
                activate_process.communicate()  # 等待命令执行完毕

                install_process = subprocess.Popen(install_command, shell=True, stdout=subprocess.PIPE,
                                                   stderr=subprocess.PIPE)
                install_process.communicate()  # 等待命令执行完毕

                QMessageBox.information(self, "成功", f"成功撤销删除依赖库: {dependency_name}")
                self.refresh_dependencies_list()
            else:
                QMessageBox.warning(self, "警告", "没有可撤销的删除操作")
        except Exception as e:
            QMessageBox.critical(self, "错误", f"撤销删除依赖库时出错: {str(e)}")

    def show_dependency_files(self):
        try:
            # 初始化为根目录
            virtualenv_path = self.virtualenv_folder_edit.text()
            if not virtualenv_path:
                QMessageBox.warning(self, "警告", "请选择虚拟环境文件夹")
                return
            self.current_directory = os.path.join(virtualenv_path, 'Lib', 'site-packages')
            items = []
            files_and_folders = os.listdir(self.current_directory)
            for item in files_and_folders:
                item_path = os.path.join(self.current_directory, item)
                if os.path.isfile(item_path):
                    size = os.path.getsize(item_path)
                    # 将文件大小转换为 KB
                    size_kb = size / 1024
                    items.append((item, size_kb, "File"))
                elif os.path.isdir(item_path):
                    items.append((item, 0, "Folder"))

            # 创建一个新的对话框来显示文件和文件夹列表
            dialog = QDialog(self)
            dialog.setWindowTitle("依赖库文件和文件夹列表")
            dialog.resize(800, 600)
            layout = QVBoxLayout(dialog)
            list_widget = QTableWidget()
            list_widget.setSelectionBehavior(QAbstractItemView.SelectionBehavior.SelectRows)
            list_widget.setRowCount(len(items))
            list_widget.setColumnCount(2)
            list_widget.setHorizontalHeaderLabels(["名称", "大小(KB)"])
            list_widget.horizontalHeader().setSectionResizeMode(QHeaderView.ResizeMode.Stretch)

            for row, (item, size_kb, item_type) in enumerate(items):
                item_name = QTableWidgetItem(item)
                item_size = QTableWidgetItem(f"{size_kb:.2f} KB" if item_type == "File" else "文件夹")
                list_widget.setItem(row, 0, item_name)
                list_widget.setItem(row, 1, item_size)

            # 设置文件大小列为可排序
            list_widget.setSortingEnabled(True)
            list_widget.sortItems(1, Qt.SortOrder.AscendingOrder)
            layout.addWidget(list_widget)

            # 创建前进和后退按钮
            forward_button = QPushButton("前进")
            backward_button = QPushButton("后退")
            run_button = QPushButton("运行")
            delete_button = QPushButton("删除")
            undo_button = QPushButton("撤销")

            # 创建红色、绿色和清除颜色按钮
            red_button_color = QColor("red").lighter(150)
            green_button_color = QColor("green").lighter(150)
            white_button_color = QColor("white").lighter(150)

            # 设置按钮的背景颜色
            red_button = QPushButton("红色")
            red_button.setStyleSheet(f"background-color: {red_button_color.name()};")
            green_button = QPushButton("绿色")
            green_button.setStyleSheet(f"background-color: {green_button_color.name()};")
            clear_color_button = QPushButton("清除颜色")
            clear_color_button.setStyleSheet(f"background-color: {white_button_color.name()};")

            # 定义按钮的点击事件
            forward_button.clicked.connect(lambda: self.enter_subdirectory(dialog, list_widget))
            backward_button.clicked.connect(lambda: self.return_to_parent(list_widget))
            run_button.clicked.connect(self.run_python_file)
            delete_button.clicked.connect(lambda: self.delete_files(list_widget))
            undo_button.clicked.connect(lambda: self.undo_delete(list_widget))
            red_button.clicked.connect(lambda: self.set_row_color(list_widget, QColor("red")))
            green_button.clicked.connect(lambda: self.set_row_color(list_widget, QColor("green")))
            clear_color_button.clicked.connect(lambda: self.clear_row_color(list_widget))

            # 将按钮添加到布局中
            button_layout = QHBoxLayout()
            button_layout.addWidget(backward_button)
            button_layout.addWidget(forward_button)
            button_layout.addWidget(run_button)
            button_layout.addWidget(delete_button)
            button_layout.addWidget(undo_button)
            layout.addLayout(button_layout)

            color_button_layout = QHBoxLayout()
            color_button_layout.addWidget(red_button)
            color_button_layout.addWidget(green_button)
            color_button_layout.addWidget(clear_color_button)
            layout.addLayout(color_button_layout)

            dialog.setLayout(layout)
            dialog.exec()

        except Exception as e:
            QMessageBox.critical(self, "错误", f"显示依赖库文件和文件夹时出错: {str(e)}")

    def set_row_color(self, table_widget, color):
        selected_rows = table_widget.selectionModel().selectedRows()
        for row in selected_rows:
            for column in range(table_widget.columnCount()):
                item = table_widget.item(row.row(), column)
                item.setBackground(color)

    def clear_row_color(self, table_widget):
        for item in table_widget.selectedItems():
            item.setBackground(QColor("white"))

    def refresh_dependency_files_list(self, list_widget):
        # 刷新列表
        try:
            items = []
            files_and_folders = os.listdir(self.current_directory)
            for item in files_and_folders:
                item_path = os.path.join(self.current_directory, item)
                if os.path.isfile(item_path):
                    size = os.path.getsize(item_path)
                    # 将文件大小转换为 KB
                    size_kb = size / 1024
                    items.append((item, size_kb, "File"))
                elif os.path.isdir(item_path):
                    items.append((item, 0, "Folder"))

            # 清空列表视图并添加新的文件和文件夹列表
            list_widget.clear()
            list_widget.setRowCount(len(items))
            list_widget.setColumnCount(2)
            list_widget.setHorizontalHeaderLabels(["名称", "大小(KB)"])

            for row, (item, size_kb, item_type) in enumerate(items):
                item_name = QTableWidgetItem(item)
                item_size = QTableWidgetItem(f"{size_kb:.2f} KB" if item_type == "File" else "文件夹")
                list_widget.setItem(row, 0, item_name)
                list_widget.setItem(row, 1, item_size)

        except Exception as e:
            QMessageBox.critical(self, "错误", f"刷新依赖库文件和文件夹列表时出错: {str(e)}")

    def delete_files(self, list_widget):
        try:
            # 获取要删除的文件信息
            selected_rows = list_widget.selectionModel().selectedRows()
            if not selected_rows:
                QMessageBox.warning(self, "警告", "请选择要删除的文件")
                return

            files_to_delete = []
            for selected_row in selected_rows:
                item_name = list_widget.item(selected_row.row(), 0).text()
                item_path = os.path.join(self.current_directory, item_name)
                files_to_delete.append((item_name, item_path))

            # 检查并创建备份文件夹
            if not os.path.exists(self.backup_folder):
                os.makedirs(self.backup_folder)

            # 备份文件并记录路径信息
            for file_name, file_path in files_to_delete:
                new_file_path = os.path.join(self.backup_folder, file_name)
                shutil.move(file_path, new_file_path)
                self.record_deleted_file(file_name, file_path)

            # 刷新列表
            QMessageBox.information(self, "成功", "文件已成功移动到备份文件夹")
            self.refresh_dependency_files_list(list_widget)
        except Exception as e:
            QMessageBox.critical(self, "错误", f"删除文件时出错: {str(e)}")

    def undo_delete(self, list_widget):
        try:
            # 读取配置文件中的路径信息
            with open(self.config_file, 'r') as f:
                deleted_files = json.load(f)

            if not deleted_files:
                QMessageBox.warning(self, "警告", "没有可撤销的删除操作")
                return

            # 选择要撤销删除的文件
            selected_file, ok = QInputDialog.getItem(self, "选择要撤销的文件", "选择要撤销的文件:",
                                                     deleted_files.keys(), 0, False)
            if not ok:
                return

            # 恢复文件到原始位置
            original_path = deleted_files[selected_file]
            shutil.move(os.path.join(self.backup_folder, selected_file), original_path)
            self.refresh_dependency_files_list(list_widget)

            # 删除配置文件中的相应条目
            del deleted_files[selected_file]
            with open(self.config_file, 'w') as f:
                json.dump(deleted_files, f)

            QMessageBox.information(self, "成功", f"成功撤销删除操作：{selected_file}")
        except Exception as e:
            QMessageBox.critical(self, "错误", f"撤销删除操作时出错: {str(e)}")

    def record_deleted_file(self, file_name, file_path):
        try:
            # 读取现有的已删除文件记录
            if os.path.exists(self.config_file):
                with open(self.config_file, 'r') as f:
                    deleted_files = json.load(f)
            else:
                deleted_files = {}

            # 添加新的已删除文件记录
            deleted_files[file_name] = file_path

            # 更新配置文件
            with open(self.config_file, 'w') as f:
                json.dump(deleted_files, f)
        except Exception as e:
            QMessageBox.critical(self, "错误", f"记录已删除文件时出错: {str(e)}")

    def enter_subdirectory(self, dialog, list_widget):
        try:
            selected_row = list_widget.currentRow()
            item_name = list_widget.item(selected_row, 0).text()
            item_path = os.path.join(self.current_directory, item_name)

            if os.path.isdir(item_path):
                # 更新当前目录路径
                self.current_directory = item_path

                # 获取下一级目录的文件和文件夹列表
                sub_items = []
                files_and_folders = os.listdir(item_path)
                for sub_item in files_and_folders:
                    sub_item_path = os.path.join(item_path, sub_item)
                    if os.path.isfile(sub_item_path):
                        size = os.path.getsize(sub_item_path)
                        # 将文件大小转换为 KB
                        size_kb = size / 1024
                        sub_items.append((sub_item, size_kb, "File"))
                    elif os.path.isdir(sub_item_path):
                        sub_items.append((sub_item, 0, "Folder"))

                # 清空列表视图并添加新的文件和文件夹列表
                list_widget.clear()
                list_widget.setRowCount(len(sub_items))
                list_widget.setColumnCount(2)
                list_widget.setHorizontalHeaderLabels(["名称", "大小(KB)"])

                for row, (sub_item_name, size_kb, item_type) in enumerate(sub_items):
                    sub_item_name_item = QTableWidgetItem(sub_item_name)
                    size_item = QTableWidgetItem(f"{size_kb:.2f} KB" if item_type == "File" else "文件夹")
                    list_widget.setItem(row, 0, sub_item_name_item)
                    list_widget.setItem(row, 1, size_item)

        except Exception as e:
            QMessageBox.critical(self, "错误", f"打开文件夹时出错: {str(e)}")

    def return_to_parent(self, list_widget):
        try:
            # 获取上一级目录
            parent_directory = os.path.dirname(self.current_directory)
            if parent_directory:
                self.current_directory = parent_directory

                # 获取上一级目录的文件和文件夹列表
                parent_items = []
                files_and_folders = os.listdir(parent_directory)
                for item in files_and_folders:
                    item_path = os.path.join(parent_directory, item)
                    if os.path.isfile(item_path):
                        size = os.path.getsize(item_path)
                        # 将文件大小转换为 KB
                        size_kb = size / 1024
                        parent_items.append((item, size_kb, "File"))
                    elif os.path.isdir(item_path):
                        parent_items.append((item, 0, "Folder"))

                # 清空列表视图并添加新的文件和文件夹列表
                list_widget.clear()
                list_widget.setRowCount(len(parent_items))
                list_widget.setColumnCount(2)
                list_widget.setHorizontalHeaderLabels(["名称", "大小(KB)"])

                for row, (item_name, size_kb, item_type) in enumerate(parent_items):
                    item_name_item = QTableWidgetItem(item_name)
                    size_item = QTableWidgetItem(f"{size_kb:.2f} KB" if item_type == "File" else "文件夹")
                    list_widget.setItem(row, 0, item_name_item)
                    list_widget.setItem(row, 1, size_item)
        except Exception as e:
            QMessageBox.critical(self, "错误", f"返回上一级目录时出错: {str(e)}")
